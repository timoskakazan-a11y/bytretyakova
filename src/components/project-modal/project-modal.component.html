
@if (project(); as p) {
  <div 
    id="modal-backdrop"
    (click)="handleBackdropClick($event)"
    class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 animate-fade-in">
    
    <div class="bg-[#F8F5F2] rounded-lg shadow-2xl w-full max-w-5xl max-h-[90vh] flex flex-col md:flex-row overflow-hidden relative">
      <!-- Close Button -->
      <button (click)="closeModal()" class="absolute top-4 right-4 text-white md:text-stone-700 bg-black/30 md:bg-transparent rounded-full p-1 z-20 hover:scale-110 transition-transform">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>

      <!-- Image Carousel -->
      <div class="w-full md:w-2/3 relative flex-shrink-0 bg-stone-200">
        @for (image of p.images; track image; let i = $index) {
          @if (i === currentImageIndex()) {
            <div class="w-full h-64 md:h-full animate-fade-in-slow">
              <img [ngSrc]="image" alt="Фото проекта {{p.title}}" class="w-full h-full object-cover" width="800" height="800" priority>
            </div>
          }
        }

        @if (totalImages() > 1) {
          <div class="absolute inset-0 flex justify-between items-center px-2">
            <button (click)="prevImage()" class="bg-black/40 text-white rounded-full p-2 hover:bg-black/60 transition-colors">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
              </svg>
            </button>
            <button (click)="nextImage()" class="bg-black/40 text-white rounded-full p-2 hover:bg-black/60 transition-colors">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" />
              </svg>
            </button>
          </div>
          <div class="absolute bottom-4 left-1/2 -translate-x-1/2 flex space-x-2">
             @for (image of p.images; track image; let i = $index) {
              <div class="w-2 h-2 rounded-full transition-colors" [class.bg-white]="i === currentImageIndex()" [class.bg-white/50]="i !== currentImageIndex()"></div>
            }
          </div>
        }
      </div>
      
      <!-- Project Info -->
      <div class="w-full md:w-1/3 p-6 md:p-8 overflow-y-auto">
        <h3 class="text-2xl md:text-3xl font-serif text-stone-800 mb-2">{{ p.title }}</h3>
        <p class="text-sm text-stone-500 mb-4 font-semibold uppercase tracking-wider">{{ p.category }}</p>
        <p class="text-stone-600 leading-relaxed">{{ p.description }}</p>
      </div>
    </div>
  </div>
}

<style>
  .animate-fade-in { animation: fadeIn 0.3s ease-out forwards; }
  .animate-fade-in-slow { animation: fadeIn 0.5s ease-out forwards; }
  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
</style>
